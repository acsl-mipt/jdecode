<h3 id="streams-app">Поток данных прикладного уровня</h3>
<div>
    <p>Поток данных прикладного уровня делится на командный и телеметрический.
    <hr/>

    <h4 id="streams-app-cmd">Командный поток данных прикладного уровня</h4>
    <div>
        <p>Входящий командный поток:
        <table class="table table-bordered" style="width:auto">
            <tbody>
            <tr>
                <td><a href="#streams-app-cmd-packet">Командное сообщение
                <td><a href="#streams-app-cmd-packet">Командное сообщение
                <td>...
            </tbody>
        </table>
        <p>Обратный командный поток:
        <table class="table table-bordered" style="width:auto">
            <tbody>
            <tr>
                <td><a href="#streams-app-cmd-result">Результат исполнения команды
                <td><a href="#streams-app-cmd-result">Результат исполнения команды
                <td>...
            </tbody>
        </table>
        <hr/>

        <h5 id="streams-app-cmd-packet">Командное сообщение</h5>
        <div>
            <p>Пакет служит для передачи командного сообщения.
                <table class="table table-bordered">
                    <thead>
                    <tr><th>Название
                        <th>Тип
                        <th>Значение
                        <th>Описание
                    </thead>
                    <tbody>
                    <tr><td rowspan="2">Заголовок командного сообщения
                        <td rowspan="2">u8
                        <td>0x0С
                        <td rowspan="2">
                    <tr><td>0x65
                    <tr><td>Длина данных (S)
                        <td>varuint
                        <td>
                        <td>Длина данных сообщения
                    <tr><td colspan="4"><strong>Данные сообщения</strong>
                        <table class="table table-bordered"><tbody>
                        <tr><td>Команда 1
                            <td rowspan="4">
            <p>Команда кодируется в следующем виде:
            <table class="table table-bordered">
                <tbody>
                <tr>
                    <td>Номер бортового компонента
                    <td>varuint
                    <td>Определяет номер компонента к которому относится сообщение
                <tr>
                    <td>Номер команды
                    <td>varuint
                    <td>Определяет номер команды в рамках компонента
                <tr>
                    <td>Данные параметров команды
                    <td>varuint
                    <td>Параметры команды
                </tbody>
            </table>
            <tr><td>Команда 2
            <tr><td>...
            <tr><td>Команда N
                </tbody></table>
                </tbody>
                </table>
        </div>

        <h5 id="streams-app-control-result">Результат исполнения команды</h5>
        <div>
            <p>Пакет содержит данные результата исполнения команды.
            <table class="table table-bordered">
                <thead>
                <tr><th>Название
                    <th>Тип
                    <th>Значение
                    <th>Описание
                </thead>
                <tbody>
                <tr><td rowspan="2">Заголовок пакета результата исполнения команды
                    <td rowspan="2">u8
                    <td>0x0С
                    <td rowspan="2">
                <tr><td>0x66
                <tr><td>Длина данных (S)
                    <td>varuint
                    <td>
                    <td>Длина данных сообщения
                <tr><td>Результат исполнения команды (данные сообщения)
                    <td>[u8, S]
                    <td>
                    <td>
                </tbody>
            </table>
        </div>
    </div>
    <hr/>

    <h4 id="streams-app-tm">Телеметрический поток данных прикладного уровня</h4>
    <div>
        <p>ТМ-информация состоит из пакетов ТМ-сообщений. ТМ-сообщение может быть одного из двух типов:
        <ul>
            <li>Событийное ТМ-сообщение предназначено для уведомления наземного комплекса управления (НКУ) о наступлении определенного события на борту, например о возникновении ошибки, смене режимов, выхода параметров за допустимые пределы, получении и исполнении команды и т.п. Событийные сообщения привязываются к точному бортовому времени возникновения события.
            <li>Статусное ТМ-сообщение предназначено для передачи информации о внутреннем состоянии бортового комплекса и может формироваться как циклически, так и в соответствии с внутренней логикой работы компонентов.
        </ul>
        <p>ТМ-сообщение включает значения бортовых параметров в данных ТМ-сообщения. Перечень и тип передаваемых параметров определяается на основе базы данных бортовых параметров по номеру компонента и номеру ТМ-сообщения.

        <p>Телеметрический исходящий поток:
        <table class="table table-bordered" style="width:auto">
            <tbody>
            <tr>
                <td><a href="#streams-app-tm-event">Событийное ТМ-сообщение</a> | <a href="#streams-app-tm-status">Статусное ТМ-сообщение</a>
                <td><a href="#streams-app-tm-event">Событийное ТМ-сообщение</a> | <a href="#streams-app-tm-status">Статусное ТМ-сообщение</a>
                <td>...
            </tbody>
        </table>
        <p>Обратный телеметрический поток имеет вид совпадающий с исходящим.

        <h5 id="streams-app-tm-event">Событийное ТМ-сообщение</h5>
        <div>
            <p>Пакет содержит данные событийного ТМ-сообщения.
            <table class="table table-bordered">
                <thead>
                <tr><th>Название
                    <th>Тип
                    <th>Значение
                    <th>Описание
                </thead>
                <tbody>
                <tr><td rowspan="2">Заголовок событийного ТМ-сообщения
                    <td rowspan="2">u8
                    <td>0x0С
                    <td rowspan="2">
                <tr><td>0x78 (120)
                <tr><td>Длина данных (S)
                    <td>varuint
                    <td>
                    <td>Длина данных ТМ-сообщения
                <tr><td>Номер бортового компонента
                    <td>varuint
                    <td>
                    <td>Определяет номер компонента к которому относится ТМ-сообщение
                <tr><td>Номер ТМ-сообщения
                    <td>varuint
                    <td>
                    <td>Определяет номер ТМ-сообщения в рамках компонента
                <tr><td>Номер события
                    <td>varuint
                    <td>
                    <td>Определяет номер события из ТМ-сообщения
                <tr><td>Метка времени
                    <td>u32
                    <td>
                    <td>
                <tr><td>Данные параметров ТМ-сообщения
                    <td>[u8, S]
                    <td>
                    <td>Параметры ТМ-сообщения
                </tbody>
            </table>
        </div>
        <hr/>

        <h5 id="streams-app-tm-status">Статусное ТМ-сообщение</h5>
        <div>
            <p>Пакет содержит данные статусного ТМ-сообщения.
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>Название
                    <th>Тип
                    <th>Значение
                    <th>Описание
                </thead>
                <tbody>
                <tr><td rowspan="2">Заголовок статусного ТМ-сообщения
                    <td rowspan="2">u8
                    <td>0x1С
                    <td rowspan="2">
                <tr><td>0x72 (114)
                <tr><td>Длина данных (S)
                    <td>varuint
                    <td>
                    <td>Длина данных ТМ-сообщения
                <tr><td>Номер сегмента
                    <td>varuint
                    <td>
                    <td>В случае несегментированного пакета должен быть установлен в 0.
                <tr><td>Максимальный номер сегмента
                    <td>varuint
                    <td>
                    <td>В случае несегментированного пакета должен быть установлен в 0.
                <tr><td>Номер бортового компонента
                    <td>varuint
                    <td>
                    <td>Определяет номер компонента к которому относится ТМ-сообщение
                <tr><td>Номер ТМ-сообщения
                    <td>varuint
                    <td>
                    <td>Определяет номер ТМ-сообщения в рамках компонента
                <tr><td>Данные параметров ТМ-сообщения
                    <td>[u8, S]
                    <td>
                    <td>Параметры ТМ-сообщения
                </tbody>
            </table>
        </div>
    </div>
</div>
<hr/>

<h3 id="streams-combined">Комбинированный уровень</h3>
<div>
    <p>Комбинированный уровень стека протоколов это логическое представление компактного вида обменных потоков, который может быть использован в случае узкого или медленного канала связи, когда компактный вид покрывает все потребности и снижение накладных расходов при передаче данных имеет приоритет над гибкостью и расширяемостью.

    <h4 id="streams-combined-packet">Пакет комбинированного уровня</h4>
    <div>
        <p>Пакет комбинированного уровня предназначен непосредственно для передачи данных трех обобщаемых уровней: уровня мультиплексирования, обменного и прикладного уровня.
            <table class="table table-bordered">
                <thead>
                <tr><th>Название
                    <th>Тип
                    <th>Значение
                </thead>
                <tbody>
                <tr><td rowspan="2">Заголовок пакета
                    <td>u8
                    <td>0x0С
                <tr><td>u8
                    <td><ul><li>0x51 &mdash; Командный пакет
                        <li>0x52 &mdash; Ответ на команду
                        <li>0x53 &mdash; ТМ-информация
                <tr><td>Длина данных пакета (S)
                    <td>varuint
                    <td>
                <tr><td>Текущий номер сегмента
                    <td>varuint
                    <td>0 &mdash; в случае несегментированной передачи
                <tr><td>Максимальный номер сегмента
                    <td>varuint
                    <td>0 &mdash; в случае несегментированной передачи
                <tr><td>Адрес источника
                    <td>varuint
                    <td>
                <tr><td>Адрес приемника
                    <td>varuint
                    <td>
                <tr><td>Метка времени формирования пакета
                    <td>u32
                    <td>Младшие 22 бита UNIX timestamp в старших 22 битах и 10 бит миллисекунды в младших 10 битах
                <tr><td>Данные пакета
                    <td>[u8, S]
                    <td><ul><li>В случае командного пакета:
                        <table class="table table-bordered">
                            <thead>
                            <tr><th>Название
                                <th>Значение
                            </thead>
                            <tbody>
                            <tr><td>Команда 1
                                <td rowspan="4">
        <p>Команда кодируется в следующем виде:
        <table class="table table-bordered">
            <tbody>
            <tr>
                <td>Номер бортового компонента
                <td>varuint
                <td>Определяет номер компонента к которому относится сообщение
            <tr>
                <td>Номер команды
                <td>varuint
                <td>Определяет номер команды в рамках компонента
            <tr>
                <td>Данные параметров команды
                <td>[u8]
                <td>Параметры команды
            </tbody>
        </table>
        <tr><td>Команда 2
        <tr><td>...
        <tr><td>Команда N
            </tbody>
            </table>
            <li>В случае ответа на команду:
                <table class="table table-bordered">
                    <thead>
                    <tr><th>Название
                        <th>Значение
                    </thead>
                    <tbody>
                    <tr><td>Результат исполнения команды (данные сообщения)
                        <td>
                    </tbody>
                </table>
            <li>В случае ТМ-информации:
                <table class="table table-bordered">
                    <thead>
                    <tr><th>Название
                        <th>Значение
                    </thead>
                    <tbody>
                    <tr><td>ТМ-сообщение 1
                        <td><p>ТМ-сообщение кодируется в следующем виде:
                            <ul><li>Для событийного ТМ-сообщения
                                <table class="table table-bordered">
                                    <thead>
                                    <tr><th>Название
                                        <th>Тип
                                        <th>Значение
                                        <th>Описание
                                    </thead>
                                    <tbody>
                                    <tr><td>Заголовок событийного ТМ-сообщения
                                        <td>u8
                                        <td>0x00
                                        <td>
                                    <tr><td>Длина данных (S)
                                        <td>varuint
                                        <td>
                                        <td>Длина данных ТМ-сообщения
                                    <tr><td>Номер бортового компонента
                                        <td>varuint
                                        <td>
                                        <td>Определяет номер компонента к которому относится ТМ-сообщение
                                    <tr><td>Номер ТМ-сообщения
                                        <td>varuint
                                        <td>
                                        <td>Определяет номер ТМ-сообщения в рамках компонента
                                    <tr><td>Номер события
                                        <td>varuint
                                        <td>
                                        <td>Определяет номер события из ТМ-сообщения
                                    <tr><td>Метка времени формирования события
                                        <td>u32
                                        <td>Младшие 22 бита UNIX в старших 22 битах и 10 бит миллисекунды в младших 10 битах
                                    <tr><td>Данные параметров ТМ-сообщения
                                        <td>[u8, S]
                                        <td>
                                        <td>Параметры ТМ-сообщения
                                    </tbody>
                                </table>
                                <li>Для статусного ТМ-сообщения:
                                    <table class="table table-bordered">
                                        <thead>
                                        <tr>
                                            <th>Название
                                            <th>Тип
                                            <th>Значение
                                            <th>Описание
                                        </thead>
                                        <tbody>
                                        <tr><td>Заголовок статусного ТМ-сообщения
                                            <td>u8
                                            <td>0x01
                                            <td>
                                        <tr><td>Длина данных (S)
                                            <td>varuint
                                            <td>
                                            <td>Длина данных ТМ-сообщения
                                        <tr><td>Номер сегмента
                                            <td>varuint
                                            <td>
                                            <td>В случае несегментированного пакета должен быть установлен в 0.
                                        <tr><td>Максимальный номер сегмента
                                            <td>varuint
                                            <td>
                                            <td>В случае несегментированного пакета должен быть установлен в 0.
                                        <tr><td>Номер бортового компонента
                                            <td>varuint
                                            <td>
                                            <td>Определяет номер компонента к которому относится ТМ-сообщение
                                        <tr><td>Номер ТМ-сообщения
                                            <td>varuint
                                            <td>
                                            <td>Определяет номер ТМ-сообщения в рамках компонента
                                        <tr><td>Данные параметров ТМ-сообщения
                                            <td>[u8, S]
                                            <td>
                                            <td>Параметры ТМ-сообщения
                                        </tbody>
                                    </table>
                    <tr><td>ТМ-сообщение 2
                        <td>
                    <tr><td>...
                        <td>
                    <tr><td>ТМ-сообщение N
                        <td>
                    </tbody>
                </table>
        <tr><td>Значение контрольной суммы
            <td>u16
            <td>CRC-16
                </tbody>
                </table>
    </div>
</div>
<hr/>

<h3 id="streams-delimiter-parsing">Алгоритм разбора потока с разделителем</h3>
<div>
    <p>Последовательность разбора потока с разделителем следующая:
    <ol type="A">
        <li>найти в потоке разделитель;
        <li>попытаться прочесть пакет следующий сразу за разделителем:
            <ol type="1">
                <li>если пакет считан успешно, то попытаться прочесть разделитель следующий сразу за пакетом:
                    <ol type="a">
                        <li>если разделитель считан успешно, то продолжать разбор с пункта B;
                        <li>если разделитель не был считан успешно, то попытаться считать пакет данных со смещением в длину разделителя от конца предыдущего пакета (разделитель может быть испорчен при передаче):
                            <ol type="i">
                                <li>если пакет считан успешно, то продолжить с пункта 1;
                                <li>если пакет не был считан, то начать с самого начала (пункт A) в поисках нового разделителя.
                            </ol>
                    </ol>
                <li>если пакет не был считан, то продолжить с пункта A.
            </ol>
    </ol>
</div>
<hr>

<h3 id="streams-ecc">Блок защиты целостности данных пакета</h3>
<div>
    <p>Блок защиты целостности данных имеет следущую структуру:
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Название
            <th>Тип
            <th>Значение
        </thead>
        <tbody>
        <tr><td>Вид защиты целостности информации
            <td>varuint
            <td><ul>
                <li>1 &mdash; Контрольная сумма CRC-16. Длина контрольной суммы 2 байта.
                <li>2 &mdash; Коды Рида-Соломона. Длина контрольной последовательности 64 байта.
            </ul>
        </tbody>
    </table>
    <p>В расчете контрольной суммы используются все данные пакета и его заголовка, кроме самого значения контрольной суммы, которое располагается в самом конце данных пакета.
</div>
<hr/>

<h3 id="streams-checksum">Блок контрольной суммы</h3>
<div>
    <p>Блок контрольной суммы имеет следущую структуру:
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Название
            <th>Тип
            <th>Значение
        </thead>
        <tbody>
        <tr><td>Занчение контрольной суммы
            <td><ul><li>u16 в случае вида защиты 1
                <li>[u8, 64] в случае вида защиты 2
            <td><ul>
                <li>1 &mdash; Контрольная сумма CRC-16. Длина контрольной суммы 2 байта.
                <li>2 &mdash; Коды Рида-Соломона. Длина контрольной последовательности 64 байта.
            </ul>
        </tbody>
    </table>
    <p>В расчете контрольной суммы используются все данные пакета и его заголовка, кроме самого значения контрольной суммы, которое располагается в самом конце данных пакета.
</div>
<hr/>

<h3 id="streams-timestamp">Блок метки времени</h3>
<div>
    <p>Блок контрольной суммы имеет следущую структуру:
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Название
            <th>Тип
            <th>Значение
        </thead>
        <tbody>
        <tr><td>Вид метки времени
            <td>varuint
            <td>2 &mdash; Младшие 22 бита UNIX timestamp в старших 22 битах и 10 бит миллисекунды в младших 10 битах
        <tr><td>Метка времени формирования пакета
            <td>В соответствии с установленным видом метки времени
            <td>
        </tbody>
    </table>
</div>
<hr/>

<h3 id="streams-address">Блок адресации</h3>
<div>
    <p>Блок адресации имеет следущую структуру:
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Название
            <th>Тип
            <th>Значение
        </thead>
        <tbody>
        <tr><td>Вид адресации
            <td>varuint
            <td>
            <td>
                <ul>
                    <li>2 &mdash; Адресация аппарата: источник / приемник
                    <li>4 &mdash; Адресация в сети: источник + компонент / приемник + компонент
                    <li>6 &mdash; Групповая адресация: группа источника + источник в группе + компонент / группа приемника + приемник в
                        группе + компонент
                </ul>
        <tr><td>Адрес источника
            <td>varuint
            <td>
            <td>
        <tr><td>Адрес приемника
            <td>varuint
            <td>
            <td>
        <tr><td>Номер компонента источника
            <td>varuint
            <td>
            <td>Формируется только в случае адресации 4, 6
        <tr><td>Номер компонента приемника
            <td>varuint
            <td>
            <td>Формируется только в случае адресации 4, 6
        <tr><td>Группа источника
            <td>varuint
            <td>
            <td>Формируется только в случае вида адресации 6
        <tr><td>Группа приемника
            <td>varuint
            <td>
            <td>Формируется только в случае вида адресации 6
        </tbody>
    </table>
</div>



</div>
<hr/>

<h2 id="arch">Архитектура бортовой системы</h2>
<div>
    <h3 id="arch-comp">Компонентная архитектура бортовой программы</h3>
    <div>
        <p>Бортовая система описывается в виде иерархии системных или функциональных блоков ПО &mdash; компонентов. Каждый компонент представляет собой набор параметров, которые данным компонентом могут быть сформированы в составе сообщений телеметрической (ТМ) информации, самих ТМ-сообщений, которые могут быть выданы на наземный комплекс управления (НКУ) или в другой аппарат, а так же набором команд посредством вызова которых может быть осуществлено управления компонентом.
        <p>Компонент может так же включать в себя другие компоненты (подкомпоненты), выстраивая таким образом иерархию и позволяя переиспользование готовых блоков функциональности бортовых систем. Компонент включающий подкомпоненты  должен реализовывать исполнение команд этих подкомпонентов (и всех их подкомпонентов), формирование и выдачу их ТМ-сообщений, и, кроме того, может формировать ТМ-сообщения включающие как свои собственные ТМ-параметры, так и параметры подкомпонентов.
        <p>Каждому аппарату ставится в соответствие один компонент аппарата, который должен полностью описывать все возможные подкомпоненты, команды и ТМ-сообщения, которые аппаратом поддерживаются.
        <p>Для описания компонентов бортового ПО спроектирована предметная модель и язык <abbr title="от DEvice COmponents DEfinition">Decode</abbr>.
    </div>
    <hr/>

    <h3 id="arch-tm">Формирование и выдача телеметрической информации</h3>
    <div>
        <p>В архитектуре бортовой системы предусмотрен отдельный компонент отвечающий за сбор, формирование и выдачу ТМ-информации с борта на НКУ и на другие аппараты. Минимальной единицей выдаваемой ТМ-информации является ТМ-сообщение состоящее из набора ТМ-параметров.
        <p>ТМ-информация делится на:
        <ul>
            <li>статусную информацию, которая формируется из актуальных значений параметров бортового комплекса на момент формирования и в общем случае не привязана к наступлению определенных событий в бортовой системе;
            <li>событийную информацию, которая привязана к наступлению определенных событий (например, возникновению ошибок) и формируется непосредственно в момент наступления события.
        </ul>
        <p><a href="#decode">Полное описание команд и ТМ-сообщений компонента реализовано на языке Decode.</a>
        <hr/>

        <h4 id="arch-tm-status">Формирование статусной ТМ-информации</h4>
        <div>
            <p>Формирование статусной ТМ-информации производится компонентом формирования ТМ-информации циклически в соответствии с приоритетами. Каждый приоритет от 1 и далее указывает на то, что независимо от ширины канала связи формирование ТМ-сообщений с приоритетом N производится с частотой в 2 раза более высокой, чем сообщений с приоритетом N+1. Таким образом на каждое сообщение с приоритетом 3 будет выдано 2 сообщения с приоритетом 2 и 4 сообщения с приоритетом 1.
            <p>Очередность выдачи сообщений задается их порядком в таблице статусных ТМ-сообщений, которая формируется на основе всех статусных ТМ-сообщений всех входящих в бортовую систему компонентов. ТМ-компонент позволяет гибко управлять формированием статусной ТМ-информации, а именно: изменять приоритеты ТМ-сообщений в процессе работы, включать и выключать формирование отдельных ТМ-сообщений или всех сообщений определенного компонента.
            <p>Статусные сообщения могут быть сформированы и вне циклической выдачи непосредственно по запросу от бортового кода, в этом случае формирование сообщения происходит в момент запроса, а выдача раньше циклической выдачи статусных сообщений. Так же предусмотрена возможность установки заявки на однократное формирование статусного ТМ-сообщения, которое будет сформировано и выдано при формировании и выдаче циклической статусной информации, но с более высоким приоритетом, чем любые другие циклические ТМ-сообщения.
            <p>При формировании статусного ТМ-сообщения большой длины производится его выдача в виде сегментов. С момента формирования сообщения до его полной выдачи все данные хранятся внутри компонента ТМ. Важно отметить, что формирование сегментированного сообщения производится одномоментно и в полном объеме, за счет чего обеспечивается согласованность данных параметров ТМ-сообщения.
        </div>
        <hr/>

        <h4 id="arch-tm-event">Формирование событийной ТМ-информации</h4>
        <div>
            <p>Событийная ТМ-информация формируется по запросу от бортового кода и помещается в циклический буфер в соответствии с приоритетом ТМ-сообщения. Выдача сформированных сообщений производится в очередности определяемой приоритетом. Пока не будут выданы все сообщения более высокого приоритета выдача других сообщения не производится.
            <p>Компонент телеметрии предусматривает возможности ограничения формирования событийных сообщений: как всех сообщений определенного компонента, так и только определенного ТМ-сообщения компонента или определенного события событийного ТМ-сообщения.
            <p>При переполнении циклических буферов событийных сообщений происходит затирание старых сообщений новыми, при этом номер ТМ-сообщения и номер события отмечается в массиве утерянных сообщений. Когда производится выдача сообщения с перечнем утерянных событийных сообщений, то список очищается.
        </div>
    </div>
    <hr/>

    <h3 id="arch-script">Управление бортовыми скриптами (циклограммами)</h3>
    <div>
        <p>Компонент управления бортовыми скриптами позволяет управлять загрузкой, выгрузкой, исполнением и планированием запуска бортовых программ.
        <p>Бортовая программа представляет собой скомпилированный байт-код виртуальной бортовой машины, который исполняется в рамках работы бортовой вычислительной системы независимо от доступности НКУ и наличия связи с НКУ и другими аппаратами.
        <p>Компонент управления цкилограммами поддерживает возможность отложенного запуска скрипта, планирования запуска по времени, а так же периодический запуск скриптов.
        <p><a href="#decode">Полное описание команд и ТМ-сообщений компонента реализовано на языке Decode.</a>
    </div>

</div>
<hr/>

<h2 id="segment">Использование сегментированной передачи</h2>
<div>
    <p>Сегментированная передача данных используется для мултиплексирования передачи больших объемов данных в составе телеметрического потока с передачей других данных, таких как событийная
        ТМ-информация.
    <p>При передаче сегментированных данных (в случае, когда максимальный номер сегмента не равен 0) данные считаются полученными в случае получения и успешной валидации всех сегментов данных.
    <p>Если источник и приемник поддерживают интерфейс досылки и гарантированной передачи сегментированных данных, то они могут контролировать отправку и получение отдельных сегментов:
    <ul>
        <li>Источник может предварительно отправить пакет с командой на включение режима гарантированной передачи сегментированного пакета. Тем самым он обязуется хранить все сегменты данных отправленных приемнику и пересылать их в случае утери и до получения команды от приемника уведомляющей о получении всех сегментов приемником.
        <li>В режиме гарантированной передачи сегментированных данных приемник должен формировать команды запрашивающие пересылку неполученных или некорректных сегментов в случае получения номера сегмента отличного от следующего ожидаемого.
        <li>После получения последнего сегмента с номером равным максимальному сегменту приемник должен периодически отсылать запрос на пересылку отсутствующих сегментов. При получении всех сегментов приемник должен оповестить источник командой о том, что сегментированная передача успешно завершена. После получения такого оповещения источник может освободить ресурсы занятые на хранение всех сегментов данных.
        <li>При необходимости источник с помощью команды так же может запросить подтверждение о получении каждого сегмента по мере их прохождения и валидации, в этом случае приемник должен формировать команды оповещения на получение каждого корректного сегмента, что позволит источнику освобождать ресурсы по мере подтвержденной пересылки сегментов.
        <li>После пересылки всех требуемых сегментов приемнику, источник через некоторое время должен периодически слать команду запрос о статусе работы режима гарантированной передачи сегментированных данных. При получениии ответа о том, что режим гарантированной передачи на приемнике не активен передача сегментированных данных считается завершенной. В случае отсутствия обратной связи от приемника в режиме гарантированной передачи формируется сообщение об ошибке с некоторой периодичностью до тех пор, пока режим не будет выключен вручную или приемник не ответит на запросы.
    </ul>
    <p><a href="#decode">Полное описание команд и ТМ-сообщений компонента реализовано на языке Decode.</a>
    </p></div>
<hr>

<h2 id="identification">Расширение для динамической идентификации устройств и их интерфейсов</h2>
<div>
    <p>Для работы в сетях с разнородными устройствами и различными прошивками требуется динамическая идентификация устройств и интерфейсов реализуемых бортовым ПО (наборов компонент, а так же их ТМ- и командных сообщений). Для этого предусмотренно расширение протокола добавляющее возможность такую информацию запросить.
    <p>Для формирования команд и рабора ТМ-информации от компонента идентификации использется специальный номер компонента &mdash; 0. Команда отправленная в компонент с номером 0 всегда будет передана компоненту идентификации, а ТМ-информация от компонента с номером 0 всегда соответствует компоненту идентификации.
    <p><a href="#decode">Полное описание команд и ТМ-сообщений компонента реализовано на языке Decode.</a>
</div>
<hr/>

<h2 id="files">Расширение для загрузки и выгрузки файлов</h2>
<div>
    <p>Файловое расширение позвлояет производить загрузку и выгрузку файлов с аппарата, а так же управлять структурой
        каталогов.
    <p><a href="#decode">Полное описание команд и ТМ-сообщений компонента реализовано на языке Decode.</a>
</div>
<hr/>

<h2 id="routing">Расширение для динамической маршрутизация пакетов</h3>
    <div>
        <p>Компонент динамической маршрутизации пакетов позволяет бортовой системе выстраивать и изменять таблицу маршрутизации пакетов во время работы по информации получаемой при обмене с другими устройствами в сети. Поддерживается таблица маршрутизации как по отдельным устройствам, так и по группам устройств.
        <p>Так же компонент позволяет управлять таблицей маршрутизации в ручную или посредством скриптов как с НКУ, так и с других устройств в сети.
        <p><a href="#decode">Полное описание команд и ТМ-сообщений компонента реализовано на языке Decode.</a>
    </div>
    <hr/>

    <h2 id="decode">Описание компонентов бортовой системы на языке Decode</h2>
    <div>
    <pre style="background-color: #2b2b2b"><span class="s0">namespace </span><span class="s1">ru.mipt.acsl

</span><span class="s2">&quot;Строка&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">string [u8]

</span><span class="s2">&quot;Пара номер компонента и его уникальный идентификатор&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">component_number_guid_pair
</span><span class="s0">struct</span><span class="s1">
(
  </span><span class="s2">'Номер компонента в пределах устройства'</span><span class="s1">
  </span><span class="s0">ber  </span><span class="s1">number</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Уникальный идентификатор компонента'</span><span class="s1">
  guid guid</span><span class="s3">,</span><span class="s1">
)

</span><span class="s2">&quot;Идентификатор устройства и его корневого компонента&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">short_id
</span><span class="s0">struct</span><span class="s1">
(
  </span><span class="s2">'Уникальный идентификатор устройства'</span><span class="s1">
  guid  deviceGuid</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Уникальный идентификатор компонента устройства'</span><span class="s1">
  guid  rootComponentGuid</span><span class="s3">,</span><span class="s1">
)

</span><span class="s2">&quot;Идентификатор устройства и всех его компонентов&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">full_id </span><span class="s0">struct</span><span class="s1">
(
    short_id shortId</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Идентификаторы всех компонентов устройства'</span><span class="s1">
    [component_number_guid_pair</span><span class="s3">, </span><span class="s4">1</span><span class="s1">..*] deviceComponentGuidPairs</span><span class="s3">,</span><span class="s1">
)

</span><span class="s2">'Компонент идентификации устройства и всех его компонентов'</span><span class="s1">
</span><span class="s0">component </span><span class="s1">Identification</span><span class="s0">:</span><span class="s4">0</span><span class="s1">
{
  </span><span class="s0">parameters</span><span class="s1">
  (
    full_id fullId</span><span class="s3">,</span><span class="s1">
  )

  </span><span class="s2">'Запросить идентификатор устройства и идентификатор компонента устройства'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">requestShortId() -&gt; short_id

  </span><span class="s2">'Запросить идентификатор устройства, компонента устройства и всех его подкомпонентов'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">requestFullId() -&gt; full_id

  </span><span class="s2">'Запросить идентификатор компонента по номеру'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">requestComponentGuid(</span><span class="s0">ber </span><span class="s1">componentNumber) -&gt; guid
}

</span><span class="s2">&quot;Ошибка начала режима сегментированной выдачи&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">segment_start_ack_error </span><span class="s0">enum ber </span><span class="s1">(ALREADY_STARTED = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">INVALID_STATE = </span><span class="s4">2</span><span class="s1">)

</span><span class="s2">&quot;Ошибка останова режима сегментированной выдачи&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">segment_stop_ack_error </span><span class="s0">enum ber </span><span class="s1">(NOT_STARTED = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">INVALID_STATE = </span><span class="s4">2</span><span class="s1">)

</span><span class="s2">&quot;Ошибка обработки получения сегмента&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">segment_process_ack_error </span><span class="s0">enum ber </span><span class="s1">(INVALID_STATE = </span><span class="s4">1</span><span class="s1">)

</span><span class="s2">&quot;Компонент режима сегментированной передачи ТМ-сообщения&quot;</span><span class="s1">
</span><span class="s0">component </span><span class="s1">Segment
{
  </span><span class="s0">parameters</span><span class="s1">
  (
    </span><span class="s2">'Режим гарантированной доставки активен'</span><span class="s1">
    b8  isSegmentationAckModeActive</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Максимальный номер сегмента'</span><span class="s1">
    </span><span class="s0">ber </span><span class="s1">maxSegmentNumber</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Режим подтверждения получения каждого сегмента активен'</span><span class="s1">
    b8  isAckOnEverySegmentModeActive</span><span class="s3">,</span><span class="s1">
  )

  </span><span class="s2">'Начать режим гарантированной передачи'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">startSegmentAckMode</span><span class="s0">:</span><span class="s4">0</span><span class="s1">() -&gt; segment_start_ack_errror?

  </span><span class="s2">'Отключить режим гарантированной передачи'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">stopSegmentAckMode</span><span class="s0">:</span><span class="s4">1</span><span class="s1">() -&gt; segment_stop_ack_error?

  </span><span class="s2">'Запросить статус режима гарантированной передачи'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">requestAckModeStatus</span><span class="s0">:</span><span class="s4">2</span><span class="s1">() -&gt; b8

  </span><span class="s2">'Обработать статус режима гарантированной передачи'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">processAckModeStatus</span><span class="s0">:</span><span class="s4">3</span><span class="s1">(b8 isSegmentationAckModeActive) -&gt; segment_process_ack_error?

  </span><span class="s2">'Включить режим подтверждения получения каждого сегмента'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">startAckOnEverySegmentMode</span><span class="s0">:</span><span class="s4">4</span><span class="s1">() -&gt; segment_start_ack_errror?

  </span><span class="s2">'Выключить режим подтверждения получения каждого сегмента'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">stopAckOnEverySegmentMode</span><span class="s0">:</span><span class="s4">5</span><span class="s1">() -&gt; segment_stop_ack_error?
}

</span><span class="s2">&quot;Компонент сервера поддерживающиего сегментированную передачу ТМ-сообщения&quot;</span><span class="s1">
</span><span class="s0">component </span><span class="s1">SegmentSender </span><span class="s0">with </span><span class="s1">Segment
{
  </span><span class="s2">'Обработать подтверждения о получении сегментов'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">processSegmentsAck</span><span class="s0">:</span><span class="s4">0</span><span class="s1">([</span><span class="s0">ber</span><span class="s3">, </span><span class="s4">1</span><span class="s1">..*] segmentsReceived) -&gt; segment_process_ack_error?
}

</span><span class="s2">&quot;Компонент клиента поддерживающего сегментированное получение ТМ-сообщения&quot;</span><span class="s1">
</span><span class="s0">component </span><span class="s1">SegmentReceiver </span><span class="s0">with </span><span class="s1">Segment
{
  </span><span class="s0">parameters</span><span class="s1">
  (
    </span><span class="s2">'Перечень полученных сегментов'</span><span class="s1">
    [</span><span class="s0">ber</span><span class="s1">] segmentsReceived</span><span class="s3">,</span><span class="s1">
  )

  </span><span class="s2">'Перечень полученных сегментов'</span><span class="s1">
  </span><span class="s0">status </span><span class="s1">segmentsReceived
  (
    segmentsReceived</span><span class="s3">,</span><span class="s1">
  )

  </span><span class="s2">'Запросить перечень полученных сегментов'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">requestSegmentsAck() -&gt; [</span><span class="s0">ber</span><span class="s1">]
}

</span><span class="s5">/* Tm */</span><span class="s1">

</span><span class="s2">'Циклический массив'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">ring_buf </span><span class="s0">struct</span><span class="s1">
(
  </span><span class="s2">'Данные циклического массива'</span><span class="s1">
  [u8] data</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Смещение начала цкилического массива'</span><span class="s1">
  </span><span class="s0">ber </span><span class="s1">startOffset</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Смещение конца циклического массива'</span><span class="s1">
  </span><span class="s0">ber </span><span class="s1">endOffset</span><span class="s3">,</span><span class="s1">
)

</span><span class="s2">'Номер компонента и номер сообщения'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">comp_msg </span><span class="s0">struct</span><span class="s1">
(
  </span><span class="s2">'Номер компонента'</span><span class="s1">
  </span><span class="s0">ber </span><span class="s1">componentNum</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Номер сообщения в компоненте'</span><span class="s1">
  </span><span class="s0">ber </span><span class="s1">messageNum</span><span class="s3">,</span><span class="s1">
)

</span><span class="s2">'Информация о событии'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">event_info </span><span class="s0">struct</span><span class="s1">
(
  comp_msg componentMessage</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Номер события'</span><span class="s1">
  </span><span class="s0">ber      </span><span class="s1">eventNum</span><span class="s3">,</span><span class="s1">
)

</span><span class="s0">type </span><span class="s1">tm_cmd_error </span><span class="s0">enum ber </span><span class="s1">(INVALID_ARGUMENT = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">INVALID_STATE = </span><span class="s4">2</span><span class="s1">)

</span><span class="s2">'Управление формированием и выдачей ТМ-информации'</span><span class="s1">
</span><span class="s0">component </span><span class="s1">Tm
{
  </span><span class="s0">parameters</span><span class="s1">
  (
    </span><span class="s2">'Заявки на однократную выдачу событийных ТМ-сообщений'</span><span class="s1">
    [u8]         onceRequests</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Запреты на формирование и выдачу сообщений'</span><span class="s1">
    [[u8]]       deniedMessagesByComponent</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Заявки на выдачу событийных ТМ-сообщений в соответствии с частотой выдачи'</span><span class="s1">
    [[u8]]       priorityOrderedRequests</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Массив внеочередной выдачи ТМ-сообщений'</span><span class="s1">
    ring_buf     outOfOrderMesages</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Массив утерянных событий'</span><span class="s1">
    [event_info] lostEvents</span><span class="s3">,</span><span class="s1">
  )

  </span><span class="s2">'Выдать событийное ТМ-сообщение'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">sendEventMessage(</span><span class="s2">'Информация о событии' </span><span class="s1">event_info eventInfo) -&gt; tm_cmd_error?

  </span><span class="s2">'Выдать статусное сообщение во внеочередную выдачу'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">sendStatusMessage(comp_msg componentMessage) -&gt; tm_cmd_error?

  </span><span class="s2">'Установить запрос на выдачу в соответствии с приоритетом'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">setMessageRequest(comp_msg componentMessage</span><span class="s3">, </span><span class="s2">'Приоритет' </span><span class="s0">ber </span><span class="s1">priority) -&gt; tm_cmd_error?

  </span><span class="s2">'Снять запрос на выдачу в соответствии с приоритетом'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">clearMessageRequest(comp_msg componentMessage</span><span class="s3">, </span><span class="s2">'Приоритет' </span><span class="s0">ber </span><span class="s1">priority) -&gt; tm_cmd_error?

  </span><span class="s2">'Запретить формирование ТМ-сообщения'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">denyMessage(comp_msg componentMessage) -&gt; tm_cmd_error?

  </span><span class="s2">'Снять запрет на формирование ТМ-сообщения'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">allowMessage(comp_msg componentMessage) -&gt; tm_cmd_error?

  </span><span class="s2">'Установить запрет на формирование и выдачу события'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">denyEvent(event_info eventInfo) -&gt; tm_cmd_error?

  </span><span class="s2">'Снять запрет на формирование и выдачу события'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">allowEvent(event_info eventInfo) -&gt; tm_cmd_error?
}

</span><span class="s5">/* Scripts */</span><span class="s1">

</span><span class="s2">'Идентификатор скрипта'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">script_id guid

</span><span class="s2">'Информация о скрипте'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">script_info </span><span class="s0">struct</span><span class="s1">
(
  script_id scriptId</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Данные скрипта'</span><span class="s1">
  [u8]      scriptData</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Байткод скрипта'</span><span class="s1">
  [u8]      scriptCode</span><span class="s3">,</span><span class="s1">
)

</span><span class="s2">'Дата и время'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">date_time </span><span class="s0">ber</span><span class="s1">
</span><span class="s2">'Период времени'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">period    </span><span class="s0">ber</span><span class="s1">

</span><span class="s2">'Запланированный запуск скрипта'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">script_run_timing </span><span class="s0">struct</span><span class="s1">
(
  </span><span class="s2">'Идентификатор запланированного запуска'</span><span class="s1">
  guid        id</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Запуск запланирован'</span><span class="s1">
  b8          isActive</span><span class="s3">,</span><span class="s1">
  script_id   scriptId</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Время запуска'</span><span class="s1">
  date_time   runOn</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Периодический скрипт'</span><span class="s1">
  b8          isRepeated</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Период повторения'</span><span class="s1">
  period /s/  repeatPeriod</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Повторение ограничено'</span><span class="s1">
  b8          isRepeatingLimitedByDate</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Дата и время окончания повторения запусков скрипта'</span><span class="s1">
  date_time   repeatUntil</span><span class="s3">,</span><span class="s1">
)

</span><span class="s0">type </span><span class="s1">scripting_error </span><span class="s0">enum ber </span><span class="s1">(INVALID_ARGUMENT = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">INVALID_STATE = </span><span class="s4">2</span><span class="s1">)

</span><span class="s2">'Управление бортовыми скриптами (циклограммами)'</span><span class="s1">
</span><span class="s0">component </span><span class="s1">Scripting
{
  </span><span class="s0">parameters</span><span class="s1">
  (
    </span><span class="s2">'Идентификаторы бортовых скриптов'</span><span class="s1">
    [guid]              scriptsIds</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Бортовые скрипты'</span><span class="s1">
    [script_info]       scripts</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">'Данные планировщика запуска скриптов'</span><span class="s1">
    [script_run_timing] scriptsRunTimings</span><span class="s3">,</span><span class="s1">
  )

  </span><span class="s2">'Загрузить скрипт'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">uploadScript
  (
    script_id scriptId</span><span class="s3">,</span><span class="s1">
    [u8]      scriptData</span><span class="s3">,</span><span class="s1">
    [u8]      scriptCode</span><span class="s3">,</span><span class="s1">
  ) -&gt; scripting_error?

  </span><span class="s2">'Удалить скрипт'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">deleteScript(script_id scriptId) -&gt; scripting_error?

  </span><span class="s2">'Запустить скрипт незамедлительно'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">runScriptNow(script_id scriptId) -&gt; scripting_error?

  </span><span class="s2">'Запланировать запуск скрипта'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">scheduleScriptRun(script_run_timing scriptRunTiming) -&gt; scripting_error?

  </span><span class="s2">'Активировать запланированный запуск скрипта'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">enableScriptRunTiming(guid scriptRunTimingId) -&gt; scripting_error?

  </span><span class="s2">'Деактивировать запланированный запуск скрипта'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">disableScriptRunTiming(guid scriptRunTimingId) -&gt; scripting_error?

  </span><span class="s2">'Перечень загруженных скриптов'</span><span class="s1">
  </span><span class="s0">status </span><span class="s1">availableScriptsIds
  (
    scriptsIds</span><span class="s3">,</span><span class="s1">
  )

  </span><span class="s2">'Данные планировщика запуска скриптов'</span><span class="s1">
  </span><span class="s0">status </span><span class="s1">scriptsRunTimings
  (
    scriptsRunTimings</span><span class="s3">,</span><span class="s1">
  )
}

</span><span class="s5">/* Files */</span><span class="s1">
</span><span class="s2">'Информация о файле'</span><span class="s1">
</span><span class="s0">type </span><span class="s1">full_file_info </span><span class="s0">struct</span><span class="s1">
(
  </span><span class="s2">'Путь до файла'</span><span class="s1">
  string filePath</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Аттрибуты файла'</span><span class="s1">
  </span><span class="s0">ber    </span><span class="s1">fileAttrs</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Данные файла'</span><span class="s1">
  [u8]   fileContents</span><span class="s3">,</span><span class="s1">
)

</span><span class="s0">type </span><span class="s1">node_info </span><span class="s0">struct</span><span class="s1">
(
  </span><span class="s2">'Имя узла в пределах каталога'</span><span class="s1">
  string name</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Флаг каталога'</span><span class="s1">
  b8     isDir</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">'Аттрибуты узла'</span><span class="s1">
  </span><span class="s0">ber    </span><span class="s1">attrs</span><span class="s3">,</span><span class="s1">
)

</span><span class="s0">type </span><span class="s1">file_upload_error </span><span class="s0">enum ber </span><span class="s1">(ALREADY_EXISTS = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">CANT_WRITE = </span><span class="s4">2</span><span class="s1">)
</span><span class="s0">type </span><span class="s1">file_delete_error </span><span class="s0">enum ber </span><span class="s1">(NOT_FOUND = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">CANT_DELETE = </span><span class="s4">2</span><span class="s1">)
</span><span class="s0">type </span><span class="s1">file_download_error </span><span class="s0">enum ber </span><span class="s1">(NOT_FOUND = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">CANT_READ = </span><span class="s4">2</span><span class="s3">, </span><span class="s1">NOT_FILE = </span><span class="s4">3</span><span class="s1">)
</span><span class="s0">type </span><span class="s1">file_list_error </span><span class="s0">enum ber </span><span class="s1">(NOT_FOUND = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">CANT_READ = </span><span class="s4">2</span><span class="s3">, </span><span class="s1">NOT_DIR = </span><span class="s4">3</span><span class="s1">)
</span><span class="s0">type </span><span class="s1">file_create_dir_error </span><span class="s0">enum ber </span><span class="s1">(NOT_FOUND = </span><span class="s4">1</span><span class="s3">, </span><span class="s1">CANT_WRITE = </span><span class="s4">2</span><span class="s1">)

</span><span class="s2">&quot;Компонент поддерживающий управление файловой системой&quot;</span><span class="s1">
</span><span class="s0">component </span><span class="s1">Files
{
  </span><span class="s2">'Загрузить файл'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">uploadFile(</span><span class="s2">'Информация о загружаемом файле' </span><span class="s1">full_file_info fileInfo) -&gt; file_upload_error?

  </span><span class="s2">'Скачать файл'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">downloadFile(</span><span class="s2">'Путь до файла' </span><span class="s1">string path) -&gt; or&lt;full_file_info</span><span class="s3">, </span><span class="s1">file_download_error&gt;

  </span><span class="s2">'Удалить файл или каталог'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">deleteNode(</span><span class="s2">'Путь до узла' </span><span class="s1">string path) -&gt; file_delete_error?

  </span><span class="s2">'Запросить перечень файлов в каталоге'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">requestFileList(</span><span class="s2">'Путь до каталога' </span><span class="s1">string path) -&gt; or&lt;[node_info]</span><span class="s3">, </span><span class="s1">file_list_error&gt;

  </span><span class="s2">'Запросить создание каталога'</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">createDir(</span><span class="s2">'Путь к каталогу' </span><span class="s1">string path) -&gt; file_create_dir_error?
}

</span><span class="s2">&quot;Адрес абонента&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">address </span><span class="s0">ber</span><span class="s1">

</span><span class="s2">&quot;Запись таблицы маршрутизации&quot;</span><span class="s1">
</span><span class="s0">type </span><span class="s1">route </span><span class="s0">struct</span><span class="s1">
(
  </span><span class="s2">&quot;Адрес назначения&quot;</span><span class="s1">
  address destination_address</span><span class="s3">,</span><span class="s1">
  </span><span class="s2">&quot;Следующий узел в пути&quot;</span><span class="s1">
  address next_hop</span><span class="s3">,</span><span class="s1">
)

</span><span class="s5">/* Router, dynamic routing table */</span><span class="s1">

</span><span class="s2">&quot;Компонент реализующий возможность динамической маршрутизации и управления таблицей маршрутизации с НКУ&quot;</span><span class="s1">
</span><span class="s0">component </span><span class="s1">Router
{
  </span><span class="s0">parameters</span><span class="s1">
  (
    </span><span class="s2">&quot;Таблица маршрутизации по устройствам&quot;</span><span class="s1">
    [route] routes</span><span class="s3">,</span><span class="s1">
    </span><span class="s2">&quot;Таблица маршрутизации по группам&quot;</span><span class="s1">
    [route] groupRoutes</span><span class="s3">,</span><span class="s1">
  )

  </span><span class="s2">&quot;Установить правило маршрутизации для абонента&quot;</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">setRoute(</span><span class="s2">&quot;Адрес абонента&quot; </span><span class="s1">address address</span><span class="s3">, </span><span class="s2">&quot;Следующий узел в пути&quot; </span><span class="s1">address next_hop)

  </span><span class="s2">&quot;Удалить все правила для абонента&quot;</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">delRoute(</span><span class="s2">&quot;Адрес абонента&quot; </span><span class="s1">address address)

  </span><span class="s2">&quot;Установить правило маршрутизации для абонента&quot;</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">setGroupRoute(</span><span class="s2">&quot;Адрес группы&quot; </span><span class="s1">address groupAddress</span><span class="s3">, </span><span class="s2">&quot;Следующий узел в пути&quot; </span><span class="s1">address next_hop)

  </span><span class="s2">&quot;Удалить все правила для группы&quot;</span><span class="s1">
  </span><span class="s0">command </span><span class="s1">delGroupRoute(</span><span class="s2">&quot;Адрес группы&quot; </span><span class="s1">address groupAddress)
}</span></pre>
    </div>
